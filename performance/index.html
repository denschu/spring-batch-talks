<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Spring Batch - Performance und Skalierbarkeit</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/codecentric.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>Spring Batch</h1>
					<h3>Performance und Skalierbarkeit</h3>
					<p>
						<small><a href="http://hakim.se">Dennis Schulte</a> / <a href="http://twitter.com/denschu">@denschu</a> und <a href="http://hakim.se">Tobias Flohre</a> / <a href="http://twitter.com/denschu">@tobiasflohre</a></small>
					</p>
				</section>

				<section>
					<h2>Lokale Skalierung</h2>
					<ul>
						<li>Multi-threaded Step</li>
						<li>Parallele Steps</li>
						<li>Partitioning</li>
					</ul>
					<br><br><br>
					<h2>Verteilte Skalierung</h2>
					<ul>
						<li>Partitioning</li>
						<li>Remote Chunking</li>
					</ul>
				</section>

				<section>
					<h1>Multi-threaded Step</h1>
					<h3>Lokale Skalierung</h3>
				</section>

				<section>
					<h2>Woher kommen die Threads?</h2>
					<ul>
						<li>java.util.concurrent.Executor</li>
						<li>z.B. ThreadPoolExecutor</li>
						<li>Application-Server verwalten eigene Pools</li>
					</ul>
					<br>
					<pre><code data-trim style="font-size: 25px;" class="xml">
&lt;step id=&quot;loading&quot;&gt;
  &lt;tasklet task-executor=&quot;taskExecutor&quot; throttle-limit=&quot;5&quot;&gt;
  ...
  &lt;/tasklet&gt;
&lt;/step&gt;
					</code></pre>
				</section>

				<section>
					<h2>Multi-threaded Step</h2>
					<br>
					<pre><code data-trim style="font-size: 25px;" class="xml">
&lt;job id=&quot;multiThreadedJob&quot;&gt;
	&lt;step id=&quot;step&quot;&gt;
		&lt;tasklet task-executor=&quot;taskExecutor&quot;&gt;
			&lt;chunk reader=&quot;itemReader&quot; writer=&quot;itemWriter&quot;/&gt;
		&lt;/tasklet&gt;
	&lt;/step&gt;
&lt;/job&gt;

&lt;task:executor id="taskExecutor" pool-size=&quot;5&quot;&gt;

					</code></pre>
				</section>

				<section>
					<h2>Multi-threaded Step</h2>
					<img src="./img/multi-threaded-step.png"/>
				</section>

				<section>
					<h2>Stateful vs. Restartable</h2>
					<ul>
						<li>Stateful + Restartable = Häufigster Fall in Spring Batch</li>
						<li>ItemStream kann theoretisch Threadsafe sein!</li>
						<li>Pattern: Synchronized ItemReader/ItemStream</li>
						<li>Reader darf nicht Bottleneck sein</li>
						<li>Besser: Partitioning verwenden</li>
					</ul>
				</section>

				<section>
					<h1>Multi-threaded Step</h1>
					<h3>+ Hoch skalierbar</h3>
					<h3>+ Einfach zu konfigurieren</h3>
					<h3>- Alle Komponenten müssen thread-safe sein</h3>
				</section>

				<section>
					<h2>Parallel Steps</h2>
					<img src="./img/parallelsteps.png"/>
				</section>

				<section>
					<h2>Parallel Steps</h2>
					<br>
					<pre><code data-trim style="font-size: 25px;" class="xml">
&lt;job id=&quot;importJob&quot;> 
	&lt;split id=&quot;splitStep&quot; task-executor=&quot;taskExecutor&quot;&gt;
		&lt;flow&gt; 
			&lt;step id=&quot;partnerStep&quot;&gt;
					&lt;tasklet ref=&quot;partnerTasklet&quot;/&gt; 
			&lt;/step&gt;
		&lt;/flow&gt;
		&lt;flow&gt;
			&lt;step id=&quot;vertragStep&quot;&gt;
					&lt;tasklet ref=&quot;vertragTasklet&quot;/&gt;
			&lt;/step&gt;
		&lt;/flow&gt;
	&lt;/split&gt;
&lt;/job&gt;
					</code></pre>
				</section>

				<section>
					<h2>Partitioning</h2>
					<img src="./img/partitioning.png"/>
				</section>

				<section>
					<h2>Partitioning</h2>
					<img src="./img/partitioning-detail.png"/>
				</section>

				<section>
					<h2>Partitioning</h2>
					<img src="./img/partitioning-sequence.png"/>
				</section>

				<section>
					<h2>Partitioning</h2>
					<br>
					<pre><code data-trim style="font-size: 25px;" class="xml">
&lt;job id=&quot;partitionedFlatFileJob&quot;&gt;
		&lt;step id=&quot;step&quot;&gt;
			&lt;partition step=&quot;step1&quot; partitioner=&quot;partitioner&quot;&gt;
					&lt;handler task-executor=&quot;taskExecutor&quot; /&gt;
			&lt;/partition&gt;		
		&lt;/step&gt;
	&lt;/job&gt;
	
	&lt;bean id=&quot;partitioner&quot; class=&quot;org.springframework...MultiResourcePartitioner&quot;&gt;
	   	&lt;property name=&quot;resources&quot; value=&quot;file:inputFile*.txt&quot; /&gt;
	&lt;/bean&gt;

					</code></pre>
				</section>

				<section>
					<h1>Versch. Implementierungen</h1>
					<h3>Local (TaskExecutor)</h3>
					<h3>Spring Remoting</h3>
					<h3>JMS</h3>
					<h3>Spring Integration</h3>
				</section>

				<section>
					<h1>Partitioning</h1>
					<h3>+ Hoch skalierbar</h3>
					<h3>+ Keine transaktionale Middleware</h3>
					<h3>+ Kein Bottleneck beim ItemReader</h3>
					<h3>+ Datenlokalität</h3>
					<h3>- Struktur der Input Daten muss bekannt sein</h3>
				</section>

				<section>
					<h2>Remote Chunking</h2>
					<img src="./img/remote-chunking.png"/>
				</section>

				<section>
					<h2>Remote Chunking</h2>
					<img src="./img/remote-chunking-detail.png"/>
				</section>

				<section>
					<h1>Remote Chunking</h1>
					<h3>+ Struktur der Input Daten muss bekannt sein</h3>
					<h3>- Ggf. Bottleneck beim ItemReader</h3>
					<h3>- Transaktionale Middleware erforderlich</h3>
					<h3>- Alle Items werden serialisiert</h3>
				</section>

				<section>
					<img src="./img/skalierung-vergleich.png"/>
				</section>

			</div>

			<img src="img/logo-codecentric.png" style="margin:10px;position:fixed;left:0px;bottom:0px;"/>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
